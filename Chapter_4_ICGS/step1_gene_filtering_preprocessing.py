import numpy as npimport pandas as pdimport timeimport random# [1] data preprocessing #df1 = pd.read_csv('./data/GSE104276_all_pfc_2394_UMI_TPM_NOERCC_P5toP6.csv', index_col=0) # dimension = (genes x cells)#df2 = pd.read_csv('./data/GSE104276_all_pfc_2394_UMI_TPM_NOERCC_P6toP7.csv', index_col=0) # dimension = (genes x cells)print("starting preprocessing:")print("starting gene filtering:")df=df1#df1,df2n1 = df.shape[0] # row  genesn2 = df.shape[1] # col  cellsgene_names = []for i in range(n1):    cnt = 0    tmp = df.iloc[i,:]    for j in range(n2):        if tmp[j] == 0:            cnt += 1    if cnt > n2-10: # filtering genes with expression < 10 cells        #print(cnt)        gene_names.append(df.index[i])print("gene_names", gene_names)df__=df.drop(index=gene_names)print("starting log transformation:")df_log = df__.values.copy()df_log = np.log(df_log+1) # 取对数e; np.log2取对数2df_ = pd.DataFrame(df_log, index=df__.index, columns=df__.columns)df_.to_csv('./data/GSE104276_all_pfc_2394_UMI_TPM_NOERCC_P5toP6_preprocessing.csv')#df_.to_csv('./data/GSE104276_all_pfc_2394_UMI_TPM_NOERCC_P6toP7_preprocessing.csv')# genes with expression <= 10 cells# log e